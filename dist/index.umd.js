!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).StorageManager=t()}(this,function(){"use strict";class e{static encodeByteArrayToString(e,t){if(!(Array.isArray(e)||e instanceof Uint8Array))throw new TypeError("encodedString is neither an Array nor Uint8Array");if(!Number.isInteger(t))throw new TypeError("radix is not an integer");if((t<2||t>36)&&64!==t)throw new RangeError("radix is not between 2 and 36 or 64");if(e instanceof Uint8Array||(e=new Uint8Array(e)),64===t){if("undefined"==typeof btoa)return Buffer.from(e).toString("base64");let t="";const r=32768;for(let n=0;n<e.length;n+=r)t+=String.fromCharCode(...e.subarray(n,n+r));return btoa(t)}const r=Math.ceil(Math.log(256)/Math.log(t));return Array.from(e).map(e=>e.toString(t).padStart(r,"0")).join("")}static decodeStringToByteArray(e,t){if("string"!=typeof e)throw new TypeError("encodedString is not a string");if(!Number.isInteger(t))throw new TypeError("radix is not an integer");if((t<2||t>36)&&64!==t)throw new RangeError("radix is not between 2 and 36 or 64");if(64===t)return"undefined"==typeof atob?Uint8Array.from(Buffer.from(e,"base64")):Uint8Array.from(atob(e),e=>e.charCodeAt(0));const r=Math.ceil(Math.log(256)/Math.log(t)),n=Math.ceil(e.length/r),i=new Uint8Array(n),o=n*r;let a=0;for(let n=0;n<o;n+=r)i[a++]=parseInt(e.slice(n,n+r),t)||0;return i}}class t{static encrypt(t,r=64){let n=(new TextEncoder).encode(t);return n=this.#e(n,1),e.encodeByteArrayToString(n,r)}static decrypt(t,r=64){let n=e.decodeStringToByteArray(t,r);return n=this.#e(n,-1),(new TextDecoder).decode(n)}static#e(e,t){if(!t)return e;const r=e.length,n=new Uint32Array(256);for(let e=0;e<256;e++){let t=e^73240379*r;t=Math.imul(t^t>>>16,668269357),t=Math.imul(t^t>>>15,391538609),t^=t>>>16,n[e]=t}const i=new Uint8Array(r);for(let o=0;o<r;o++){let a=o+2654431673*r+n[255&o]|0;a^=a>>>16,a=Math.imul(a,2246818411),a^=a>>>13,a=Math.imul(a,3283267125),a^=a>>>16,i[o]=e[o]+(255&a)*t&255}return i}}class r{static version="4.1.2";static TRA=t;itemName;defaultValue;encodeFn;decodeFn;storage;#t;constructor(e,t={}){const{defaultValue:n,encodeFn:i=e=>r.TRA.encrypt(e,64),decodeFn:o=e=>r.TRA.decrypt(e,64),storage:a=window.localStorage}=t;if("string"!=typeof e)throw new TypeError("itemName is not a string");if(this.itemName=e,this.defaultValue=n,i&&"function"!=typeof i)throw new TypeError("encodeFn is defined but is not a function");if(this.encodeFn=i||(e=>e),o&&"function"!=typeof o)throw new TypeError("decodeFn is defined but is not a function");if(this.decodeFn=o||(e=>e),!(a instanceof Storage))throw new TypeError("storage must be an instance of Storage");this.storage=a,this.sync()}set value(e){this.#t=e;const t="string"==typeof e?e:"\0JSON\0 "+JSON.stringify(e);this.storage.setItem(this.itemName,this.encodeFn(t))}get value(){return this.#t??this.defaultValue}sync(e=this.decodeFn){let t=this.storage.getItem(this.itemName);return"string"!=typeof t?this.reset():(t=e(t),t.startsWith("\0JSON\0 ")?(t=t.slice(7),this.value="undefined"===t?void 0:JSON.parse(t)):this.value=t)}reset(){return this.value=this.defaultValue}remove(){this.#t=void 0,this.storage.removeItem(this.itemName)}clear(){this.#t=void 0,this.storage.clear()}isDefault(){return this.#t===this.defaultValue}}return r});
